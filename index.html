<h1>Hello!</h1>
// URL: https://observablehq.com/@cdfredrickson/cse-512-a1
// Title: CSE 512 A1
// Author: Carley Fredrickson (@cdfredrickson)
// Version: 731
// Runtime version: 1

const m0 = {
  id: "d234dbc04e2659b7@731",
  variables: [
    {
      inputs: ["md"],
      value: (function(md){return(
md`# CSE 512 A1`
)})
    },
    {
      from: "@vega/vega-lite-api",
      name: "vl",
      remote: "vl"
    },
    {
      from: "@uwdata/data-utilities",
      name: "printTable",
      remote: "printTable"
    },
    {
      from: "@uwdata/hours-of-sunshine",
      name: "data",
      remote: "data"
    },
    {
      inputs: ["vl","data"],
      value: (function(vl,data){return(
vl.markPoint()
.data(data)
.encode(
  vl.x().fieldQ('lon').scale({zero: false}),
  vl.y().fieldQ('lat').scale({zero: false}),
  vl.color().fieldQ('sunshine')
  )
  .render()
)})
    },
    {
      inputs: ["vl","data"],
      value: (function(vl,data){return(
vl.markBar()
  .data(data)
  .encode(
  vl.x().min('sunshine'),
  vl.x2().max('sunshine'),
  vl.y().fieldO('lat').scale({zero: false}),
  vl.color().fieldN('city')
).render()
)})
    },
    {
      inputs: ["vl","data"],
      value: (function(vl,data)
{
  
const area = vl.markBar().data(data)
.encode(
  vl.x().fieldO('month').sort(vl.max('monthnum')),
  vl.y().max('sunshine').scale({zero: false}),
  vl.y2().min('sunshine'),
  vl.opacity().value(0.3)
);
  
  const circle = vl.markCircle().data(data).encode(
  vl.x().fieldO('month').sort(vl.max('monthnum')).title('Month').axis({labelFontSize: 15, titleFontSize: 18, labelAngle: 0, labelPadding: 10, labelAlign: true}),
  vl.y().fieldQ('sunshine').title('Climatological Hours of Sunshine').axis({labelFontSize: 15, titleFontSize: 18}),
  vl.color().fieldN('city').sort(vl.max('lat')).title('Cities').legend({labelFontSize:15, titleFontSize: 18}),
  vl.size().fieldQ('lat').title('Latitude').scale({zero:null, range: [70, 350]}).legend({labelFontSize:15, titleFontSize: 18})
);
  
   const line = vl.markLine().data(data).encode(
vl.y().fieldQ('sunshine').title(null).axis({labels: false,grid:false}),
  vl.x().fieldO('month').sort({field: 'monthnum'}).title(null).axis({labels:false,grid:false}),
  vl.color().fieldN('city').sort({op: 'lat'}).legend(null),
  vl.opacity().value(0.8)
);

return vl.layer([circle]).width(700).height(500).title({text:'How Does Latitude Affect the Monthly Range of Sunshine Hours Across the United States?', fontSize: 20, offset: 20}).render()
}
)
    },
    {
      inputs: ["vl","data"],
      value: (function(vl,data){return(
vl.markLine().data(data).encode(
vl.y().fieldQ('sunshine').title(null).scale({zero: false}).axis({labels: false,grid:false}),
  vl.x().fieldO('month').sort({field: 'monthnum'}).title(null).axis({labels:false,grid:false}),
  vl.color().fieldN('city').sort({op: 'lat'}).legend(null),
  vl.opacity().value(0.8)
  )
.width(700).height(500).render()
)})
    },
    {
      inputs: ["vl","data"],
      value: (function(vl,data)
{
  
const area = vl.markBar().data(data)
.encode(
  vl.x().fieldO('month').sort({op:'monthnum'}),
  vl.y().max('sunshine').scale({zero: false}),
  vl.y2().min('sunshine'),
  vl.opacity().value(0.3)
);
  
  const circle = vl.markCircle({size:100}).data(data).encode(
  vl.x().fieldO('month').sort({op: 'monthnum'}).title('Month').axis({labelFontSize: 15, titleFontSize: 18, labelAngle: 0, labelPadding: 10, labelAlign: true}),
  vl.y().fieldQ('sunshine').title('Climatological Hours of Sunshine').axis({labelFontSize: 15, titleFontSize: 18}),
  vl.color().fieldN('city').sort({op: 'lat'}).title('Cities').legend({labelFontSize:15, titleFontSize: 18})
);
  

return vl.layer([area,circle]).width(700).height(500).title({text:'How Does the Range of Sunshine Hours Vary by Month Across Select US Cities?', fontSize: 20, offset: 20}).render()
}
)
    }
  ]
};

const m1 = {
  id: "@vega/vega-lite-api",
  variables: [
    {
      name: "vl",
      inputs: ["require"],
      value: (async function(require)
{
  const [vega, vegalite, api, tooltip] = await Promise.all([
    'vega@5',
    'vega-lite@3.2.1',
    'vega-lite-api@0.0.15',
    'vega-tooltip@0.17.0'
  ].map(module => require(module)));

  const options = {
    config: {
      // vega-lite default configuration
      config: {
        view: {width: 400, height: 300},
        mark: {tooltip: null}
      }
    },
    init: view => {
      // initialize tooltip handler
      view.tooltip(new tooltip.Handler().call);
      // enable horizontal scrolling for large plots
      if (view.container()) view.container().style['overflow-x'] = 'auto';
    },
    view: {
      // view constructor options
      loader: vega.loader({baseURL: 'https://vega.github.io/vega-datasets/'}),
      renderer: 'canvas'
    }
  };
  
  return api.register(vega, vegalite, options);
}
)
    }
  ]
};

const m2 = {
  id: "@uwdata/data-utilities",
  variables: [
    {
      name: "printTable",
      inputs: ["width","printValue","html"],
      value: (function(width,printValue,html){return(
function printTable(data, header, maxWidth) {
  const Align = {
    l: 'left',
    c: 'center',
    r: 'right'
  };
  
  const cellStyle = 'style="padding: 1px 3px; white-space: nowrap;"';
 
  header = header || (data[0] && Object.keys(data[0]));
  if (!header) return '';
  const fields = header.map(h => (h && h.field || h) + '');
  const aligns = header.map(h => {
    return `style="text-align:${h && Align[h.align] || Align.l}"`;
  });
  
  const lines = [];
  const maxw = maxWidth || maxWidth === undefined
    ? ` style="max-width:${+maxWidth || width}px"`
    : '';
  lines.push(`<table${maxw}>`);
  
  // header row
  lines.push('<thead><tr>');
  header.forEach((h, i) => {
    lines.push(`<th ${cellStyle} ${aligns[i]}>${h && h.title || h}</th>`);
  });
  lines.push('</tr></thead>');
  
  // data rows

  lines.push('<tbody>');
  data.forEach(d => {
    lines.push('<tr>');
    fields.map((f, i) => {
      lines.push(`<td ${cellStyle} ${aligns[i]}>${printValue(d[f])}</td>`);
    });
    lines.push('</tr>');
  });
  lines.push('</tbody>');
  
  lines.push('</table>');
  return html`<div style="overflow-x: auto;">${lines.join('')}</div>`;
}
)})
    },
    {
      name: "printValue",
      inputs: ["dateString"],
      value: (function(dateString){return(
function printValue(v) {
  if (v instanceof Date) {
    if (v.getHours() === 0 &&
        v.getMinutes() === 0 &&
        v.getSeconds() === 0 &&
        v.getMilliseconds() === 0)
    {
      return dateString(v.getFullYear(), v.getMonth()+1, v.getDate());
    } else if (v.getUTCHours() === 0 &&
               v.getUTCMinutes() === 0 &&
               v.getUTCSeconds() === 0 &&
               v.getUTCMilliseconds() === 0)
    {
      return dateString(v.getUTCFullYear(), v.getUTCMonth()+1, v.getUTCDate());
    } else {
      return v.toISOString();
    }
  } else {
    return JSON.stringify(v);
  }
}
)})
    },
    {
      name: "dateString",
      value: (function(){return(
function dateString(year, month, date) {
  return `${year}-${(month < 10 ? '0' : '') + month}-${(date < 10 ? '0' : '') + date}`;
}
)})
    }
  ]
};

const m3 = {
  id: "@uwdata/hours-of-sunshine",
  variables: [
    {
      name: "data",
      inputs: ["sun","ll","months"],
      value: (function(sun,ll,months){return(
Object.keys(sun).reduce((data, city) => {
  return data.concat(sun[city].map((d,i) => {
    return {
      city:     city,
      lon:      ll[city][1],
      lat:      ll[city][0],
      month:    months[i],
      monthnum: i,
      sunshine: d
    };
  }))
}, [])
)})
    },
    {
      name: "sun",
      value: (function(){return(
{
  "Seattle": [69,108,178,207,253,268,312,281,221,142,72,52],
  "Chicago": [135,136,187,215,281,311,318,283,226,193,113,106],
  "New York": [154,171,213,237,268,289,302,271,235,213,169,155],
  "San Francisco": [165,182,251,281,314,330,300,272,267,243,189,156],
  "Houston": [144,141,193,212,266,298,294,281,238,239,181,146],
  "Miami": [222,227,266,275,280,251,267,263,216,215,212,209]
}
)})
    },
    {
      name: "ll",
      value: (function(){return(
{
  "Seattle": [47.608013, -122.335167],
  "Chicago": [41.881832, -87.623177],
  "New York": [40.730610, -73.935242],
  "San Francisco": [37.733795, -122.446747],
  "Houston": [29.749907, -95.358421],
  "Miami": [25.761681,	-80.191788]
}
)})
    },
    {
      name: "months",
      value: (function(){return(
['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
)})
    }
  ]
};

const notebook = {
  id: "d234dbc04e2659b7@731",
  modules: [m0,m1,m2,m3]
};

export default notebook;
